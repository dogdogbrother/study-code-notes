# 计算机组成

## 计算机的总线

总线的作用就是解决不同设备之间的通信问题.例如有USB总线,PCI总线(外置显卡就是插在这里),霹雳Thunderbolt总线(苹果电脑用的)等等.

## 总线分类
分**片内总线**和**系统总线**.

* 片内总线就是cpu内部的集成线,因为cpu芯片里有告诉缓存/控制器/运算器/寄存器/中断系统,他们相互作用非常复杂.但是用一个总线统一去连接管理他们,就能简化线路.

* 系统总线用于CPU/主内存/IO设备等各组件之间的信息传输.也下分为三类,数据总线,地址总线,控制总线.

这里面涉及到了一个问题,如果当我们有2个组件设备都想进行数据的交互,可是总线只有一个,那么总线怎么去避免使用权的冲突问题呢?

仲裁方法有三种,链式查询/计时器定时查询/独立请求.具体的实现仲裁的方法我就不写了.

## 计算机内存
分**主存储器**与**辅助存储器**.

### 主存储器 -- 内存RAM(随机存取存储器)
RAM通过**电容**存储数据,必须隔一段时间刷新一次,如果掉电,那么一段时间后将丢失所有数据.

32位系统只能支持4GB的内容(2的32次方),因为对地址总线,支持32位.64位系统的内存就可以是很多大了(2的64次方=2的34次方GB这么大..)

### 辅助存储器 -- 磁盘
磁盘就是和唱片机一样,有盘片,读写磁头,机械臂杆之类的.

读取数据其实就是利用磁头的径向运动来读取磁道信息,但是怎么运动也是个问题,因为读取的顺序其实有可能是乱序的.

运动的算法大概有先来先服务算法/最短寻道时间优先/扫描算法(电梯算法)/循环扫描算法.(具体的算法实现就不写了).

### 高速缓存
读取磁盘需要磁头运动,这是种纯粹的机械运动,和cpu这种每秒动辄几亿次的配合是一种浪费.就算是和内存配合也不行,所以就催生出了一个在cpu旁边的小块和cpu直接相连的内存空间(缓存在cpu里面的数据).

缓存里面的数据其实是内存和硬盘里面数据的复制.那么性能最好的办法是把内存和硬盘的数据全部拿过来复刻在缓存里面吗?

其实不是的,数据多代表需要知道地址多,cpu在找地址的过程中也是要消耗时间的,比较好的策略是缓存只有很少的容量,只放最有性价比的数据(经常访问的数据).

但是用户的操作是有随机性的,有可能我刚才打游戏,现在就要看电影(打游戏的缓存就没一点用了,需要替换看电影的数据),这就带出了非常重要的一点.

**我们需要性能良好的缓存替换策略**.随机算法/先进先出算法FIFO/最不经常使用算法LFU/最近最少使用算法LRU.具体的算法实现我就不写了,看名字也能猜出个大概.